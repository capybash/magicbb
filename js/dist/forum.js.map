{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@capybash/magicbb/webpack/bootstrap","webpack://@capybash/magicbb/webpack/runtime/compat get default export","webpack://@capybash/magicbb/webpack/runtime/define property getters","webpack://@capybash/magicbb/webpack/runtime/hasOwnProperty shorthand","webpack://@capybash/magicbb/external root \"flarum.core.compat['forum/app']\"","webpack://@capybash/magicbb/external root \"flarum.core.compat['common/extend']\"","webpack://@capybash/magicbb/external root \"flarum.core.compat['common/components/TextEditor']\"","webpack://@capybash/magicbb/external root \"flarum.core.compat['common/components/TextEditorButton']\"","webpack://@capybash/magicbb/external root \"flarum.core.compat['common/utils/styleSelectedText']\"","webpack://@capybash/magicbb/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@capybash/magicbb/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@capybash/magicbb/external root \"flarum.core.compat['common/Component']\"","webpack://@capybash/magicbb/./src/forum/components/ColorPalettePopover.tsx","webpack://@capybash/magicbb/./src/forum/components/AlertPickerPopover.tsx","webpack://@capybash/magicbb/./src/forum/components/ImageAlignPopover.tsx","webpack://@capybash/magicbb/external root \"flarum.core.compat['common/components/Button']\"","webpack://@capybash/magicbb/./src/forum/components/MoreButtonsPopover.tsx","webpack://@capybash/magicbb/./src/forum/index.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditor'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditorButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/styleSelectedText'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","import Component from 'flarum/common/Component';\nimport app from 'flarum/forum/app';\n\nconst DEFAULT_COLORS = [\n  '#FF4D4D', '#FF8A3D', '#FFD53D', '#22C55E',\n  '#06B6D4', '#3B82F6', '#4F46E5', '#A855F7',\n  '#EB8A90', '#DED9E2', '#536873', '#FEFEE3',\n  '#2F3437', '#6B3F2B', '#121212', '#7F1D1D',\n];\n\nexport default class ColorPalettePopover extends Component {\n  oninit() {\n    this.open = false;\n    this.anchor = null;\n\n    this._onDocClick = (e) => {\n      if (!this.open) return;\n      const pop = this.popoverEl;\n      if (!pop) return;\n      if (!pop.contains(e.target) && !this.anchor?.contains(e.target)) this.close();\n    };\n\n    this._onKey = (e) => {\n      if (e.key === 'Escape') this.close();\n    };\n  }\n\n  onremove() {\n    document.removeEventListener('mousedown', this._onDocClick);\n    document.removeEventListener('keydown', this._onKey);\n  }\n\n  toggle() {\n    this.open = !this.open;\n    if (this.open) {\n      document.addEventListener('mousedown', this._onDocClick);\n      document.addEventListener('keydown', this._onKey);\n    } else {\n      document.removeEventListener('mousedown', this._onDocClick);\n      document.removeEventListener('keydown', this._onKey);\n    }\n  }\n\n  close() {\n    if (!this.open) return;\n    this.open = false;\n    document.removeEventListener('mousedown', this._onDocClick);\n    document.removeEventListener('keydown', this._onKey);\n    m.redraw();\n  }\n\n  view(vnode) {\n    const { label, colors = DEFAULT_COLORS, onSelect } = vnode.attrs;\n    const iconSetting = app.forum.attribute<string>('capybash-magicbb.icon_color');\n    const icon = iconSetting || vnode.attrs.icon || 'fas fa-palette';\n\n    const trigger = m(\n      'button.Button.Button--icon',\n      {\n        type: 'button',\n        title: label,\n        'aria-haspopup': 'dialog',\n        'aria-expanded': String(this.open),\n        style: 'background:transparent;box-shadow:none;transform:none;',\n        onclick: (e) => {\n          e.preventDefault();\n          this.toggle();\n          e.currentTarget.blur();\n        },\n        oncreate: (v) => (this.anchor = v.dom),\n      },\n      m('i', { className: `icon ${icon}`, 'aria-hidden': 'true' })\n    );\n\n    let style = null;\n    if (this.open && this.anchor) {\n      const r = this.anchor.getBoundingClientRect();\n      style = {\n        position: 'fixed',\n        left: `${r.left + r.width / 2}px`,\n        top: `${r.top}px`,\n        transform: 'translate(-50%, calc(-100% - 8px))',\n      };\n    }\n\n    return m.fragment({ key: 'magicbb-color' }, [\n      trigger,\n      this.open &&\n        m(\n          'div.Magicbb-ColorPopover',\n          {\n            style,\n            oncreate: (v) => (this.popoverEl = v.dom),\n            onremove: () => (this.popoverEl = null),\n          },\n          m(\n            'div.Magicbb-ColorGrid',\n            (colors || DEFAULT_COLORS).map((hex) =>\n              m('button.Magicbb-Color', {\n                type: 'button',\n                title: hex,\n                'aria-label': hex,\n                style: `background:${hex}`,\n                onclick: (e) => {\n                  e.preventDefault();\n                  onSelect?.(hex);\n                  this.close();\n                },\n              })\n            )\n          )\n        ),\n    ]);\n  }\n}\n\nexport { DEFAULT_COLORS };","import Component from 'flarum/common/Component';\nimport app from 'flarum/forum/app';\n\nconst ALERTS = [\n  { key: 'info',    icon: 'fas fa-circle-info',          font: '#1d4ed8', bg: '#eff6ff', border: '#60a5fa' },\n  { key: 'success', icon: 'fas fa-check',                 font: '#047857', bg: '#ecfdf5', border: '#34d399' },\n  { key: 'warning', icon: 'fas fa-triangle-exclamation',  font: '#b45309', bg: '#fffbeb', border: '#fbbf24' },\n  { key: 'error',   icon: 'fas fa-xmark',                 font: '#b91c1c', bg: '#fef2f2', border: '#f87171' },\n];\n\nexport default class AlertPickerPopover extends Component {\n  oninit() {\n    this.open = false;\n    this.anchor = null;\n\n    this._onDocClick = (e) => {\n      if (!this.open) return;\n      const pop = this.popoverEl;\n      if (!pop) return;\n      if (!pop.contains(e.target) && !this.anchor?.contains(e.target)) this.close();\n    };\n    this._onKey = (e) => { if (e.key === 'Escape') this.close(); };\n  }\n\n  onremove() {\n    document.removeEventListener('mousedown', this._onDocClick);\n    document.removeEventListener('keydown', this._onKey);\n  }\n\n  toggle() {\n    this.open = !this.open;\n    const add = document.addEventListener.bind(document);\n    const rm  = document.removeEventListener.bind(document);\n    if (this.open) {\n      add('mousedown', this._onDocClick);\n      add('keydown', this._onKey);\n    } else {\n      rm('mousedown', this._onDocClick);\n      rm('keydown', this._onKey);\n    }\n  }\n\n  close() {\n    if (!this.open) return;\n    this.open = false;\n    document.removeEventListener('mousedown', this._onDocClick);\n    document.removeEventListener('keydown', this._onKey);\n    m.redraw();\n  }\n\n  view(vnode) {\n    const { label, onSelect } = vnode.attrs;\n    const iconSetting = app.forum.attribute<string>('capybash-magicbb.icon_info');\n    const icon = iconSetting || vnode.attrs.icon || 'fas fa-circle-exclamation';\n\n    const trigger = m(\n      'button.Button.Button--icon',\n      {\n        type: 'button',\n        title: label,\n        'aria-haspopup': 'dialog',\n        'aria-expanded': String(this.open),\n        style: 'background:transparent;box-shadow:none;transform:none;',\n        onclick: (e) => { e.preventDefault(); this.toggle(); e.currentTarget.blur(); },\n        oncreate: (v) => (this.anchor = v.dom),\n      },\n      m('i', { className: `icon ${icon}`, 'aria-hidden': 'true' })\n    );\n\n    let style = null;\n    if (this.open && this.anchor) {\n      const r = this.anchor.getBoundingClientRect();\n      style = { position: 'fixed', left: `${r.left + r.width / 2}px`, top: `${r.top}px`, transform: 'translate(-50%, calc(-100% - 8px))' };\n    }\n\n    return m.fragment({ key: 'magicbb-alert' }, [\n      trigger,\n      this.open &&\n        m('div.Magicbb-AlertPopover',\n          {\n            style,\n            oncreate: (v) => (this.popoverEl = v.dom),\n            onremove: () => (this.popoverEl = null),\n          },\n          m('div.Magicbb-AlertGrid',\n            ALERTS.map((a) =>\n              m('button.Magicbb-AlertChoice',\n                {\n                  type: 'button',\n                  title: a.key,\n                  'aria-label': a.key,\n                  style: `background:${a.font}`,\n                  onclick: (e) => { e.preventDefault(); onSelect?.(a); this.close(); },\n                },\n                m('i', { className: `icon ${a.icon}`, 'aria-hidden': 'true', style: 'color:#fff' })\n              )\n            )\n          )\n        ),\n    ]);\n  }\n}\n\nexport { ALERTS };","import Component from 'flarum/common/Component';\n\nconst CHOICES = [\n  { key: 'left',   icon: 'fas fa-align-left',   title: 'Left' },\n  { key: 'center', icon: 'fas fa-align-center', title: 'Center' },\n  { key: 'right',  icon: 'fas fa-align-right',  title: 'Right' },\n];\n\nexport default class ImageAlignPopover extends Component {\n  oninit() {\n    this.isOpen = false;\n    this.anchor = null;\n    this.popover = null;\n\n    this._onDocClick = (e) => {\n      if (!this.isOpen) return;\n      const pop = this.popover;\n      const anc = this.anchor;\n      if (!pop || !anc) return;\n      if (!pop.contains(e.target) && !anc.contains(e.target)) this.close();\n    };\n\n    this._onKey = (e) => {\n      if (e.key === 'Escape') this.close();\n    };\n  }\n\n  onremove() {\n    document.removeEventListener('mousedown', this._onDocClick);\n    document.removeEventListener('keydown', this._onKey);\n  }\n\n  open() {\n    if (this.isOpen) return;\n    this.isOpen = true;\n    document.addEventListener('mousedown', this._onDocClick);\n    document.addEventListener('keydown', this._onKey);\n  }\n\n  close() {\n    if (!this.isOpen) return;\n    this.isOpen = false;\n    document.removeEventListener('mousedown', this._onDocClick);\n    document.removeEventListener('keydown', this._onKey);\n    m.redraw();\n  }\n\n  toggle() {\n    this.isOpen ? this.close() : this.open();\n  }\n\n  view(vnode) {\n    const label = vnode.attrs.label || 'Image';\n    const icon = vnode.attrs.icon || 'fas fa-images';\n    const onPick = vnode.attrs.onPick || function () {};\n\n    const trigger = m(\n      'button.Button.Button--icon',\n      {\n        type: 'button',\n        title: label,\n        'aria-haspopup': 'dialog',\n        'aria-expanded': String(this.isOpen),\n        onclick: (e) => {\n          e.preventDefault();\n          this.toggle();\n          e.currentTarget.blur();\n        },\n        oncreate: (v) => { this.anchor = v.dom; },\n        style: 'background:transparent;box-shadow:none;transform:none;',\n      },\n      m('i', { className: 'icon ' + icon, 'aria-hidden': 'true' })\n    );\n\n    let style = null;\n    if (this.isOpen && this.anchor) {\n      const r = this.anchor.getBoundingClientRect();\n      style = {\n        position: 'fixed',\n        left: (r.left + r.width / 2) + 'px',\n        top: r.top + 'px',\n        transform: 'translate(-50%, calc(-100% - 8px))',\n      };\n    }\n\n    const popover = this.isOpen\n      ? m('div.Magicbb-ImagePopover',\n          {\n            style,\n            oncreate: (v) => { this.popover = v.dom; },\n            onremove: () => { this.popover = null; },\n          },\n          m('div.Magicbb-ImageGrid',\n            CHOICES.map((c) =>\n              m(\n                'button.Magicbb-ImageChoice',\n                {\n                  type: 'button',\n                  title: c.title,\n                  'aria-label': c.title,\n                  onclick: (e) => {\n                    e.preventDefault();\n                    onPick(c.key);\n                    this.close();\n                  },\n                },\n                m('i', { className: 'icon ' + c.icon, 'aria-hidden': 'true' })\n              )\n            )\n          )\n        )\n      : null;\n\n    return [trigger, popover];\n  }\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","import Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\n\ntype PlainAction = {\n  key: string;\n  title: string;\n  icon?: string;\n  onClick: (e: MouseEvent) => void;\n};\n\ntype SubPopoverAction = {\n  key: string;\n  title: string;\n  icon?: string;\n  renderSub: () => Mithril.Children;\n};\n\ntype MenuItem = PlainAction | SubPopoverAction;\n\nfunction isSub(item: MenuItem): item is SubPopoverAction {\n  return typeof (item as any).renderSub === 'function';\n}\n\nexport default class MoreButtonsPopover extends Component<{ items: MenuItem[]; label?: string; icon?: string }> {\n  private open = false;\n  private anchor?: HTMLElement;\n  private popEl?: HTMLElement;\n  private pos = { top: -9999, left: -9999 };\n  private visible = false;\n  private raf1: number | null = null;\n  private raf2: number | null = null;\n\n  view() {\n    const { items } = this.attrs;\n\n    return (\n      <span class=\"Magicbb-MoreWrap\" style=\"display:inline-block\">\n        <Button\n          className=\"Button Button--icon Button--link\"\n          icon={this.attrs.icon || 'fas fa-wand-sparkles'}\n          onclick={(e: any) => {\n            e?.preventDefault?.();\n            this.anchor = e.currentTarget as HTMLElement;\n            this.toggle();\n          }}\n          title={this.attrs.label || 'More'}\n          aria-expanded={this.open ? 'true' : 'false'}\n          aria-haspopup=\"menu\"\n        />\n\n        {this.open && (\n          <div\n            class=\"Magicbb-MorePopover\"\n            style={{\n              top: `${this.pos.top}px`,\n              left: `${this.pos.left}px`,\n              visibility: this.visible ? 'visible' : 'hidden',\n              willChange: 'top, left',\n            }}\n            oncreate={(vnode: any) => {\n              this.popEl = vnode.dom as HTMLElement;\n              this.raf1 = requestAnimationFrame(() => {\n                this.positionAbove();\n                this.raf2 = requestAnimationFrame(() => {\n                  this.positionAbove();\n                  this.visible = true;\n                  m.redraw();\n                });\n              });\n            }}\n            onremove={() => this.cleanup()}\n            role=\"menu\"\n          >\n            <div class=\"Magicbb-MoreRow\">\n              {items.map((it) =>\n                isSub(it) ? (\n                  <span\n                    key={it.key}\n                    class=\"Magicbb-MoreBtnIcon\"\n                    title={it.title}\n                    role=\"menuitem\"\n                    tabindex=\"0\"\n                    aria-label={it.title}\n                    aria-haspopup=\"dialog\"\n                    aria-expanded=\"false\"\n                  >\n                    {it.renderSub()}\n                  </span>\n                ) : (\n                  <button\n                    key={it.key}\n                    class=\"Magicbb-MoreBtnIcon\"\n                    role=\"menuitem\"\n                    title={it.title}\n                    aria-label={it.title}\n                    type=\"button\"\n                    onclick={(e: any) => {\n                      e?.preventDefault?.();\n                      const fn = (it as PlainAction).onClick;\n                      this.close();\n                      requestAnimationFrame(() => fn(e));\n                    }}\n                  >\n                    {it.icon ? <i class={it.icon} aria-hidden=\"true\" /> : <i class=\"fas fa-circle\" style=\"opacity:.35\" aria-hidden=\"true\" />}\n                  </button>\n                )\n              )}\n            </div>\n          </div>\n        )}\n      </span>\n    );\n  }\n\n  private toggle() { this.open ? this.close() : this.openPopover(); }\n\n  private openPopover() {\n    this.open = true;\n    this.visible = false;\n    this.pos = { top: -9999, left: -9999 };\n    m.redraw();\n\n    window.addEventListener('resize', this.onWin, { passive: true });\n    window.addEventListener('scroll', this.onWin, true);\n\n    document.addEventListener('mousedown', this.onDocDownCapture, true);\n    document.addEventListener('click', this.onDocClickCapture, true);\n    document.addEventListener('keydown', this.onKey);\n  }\n\n  private close() {\n    this.open = false;\n    this.visible = false;\n    m.redraw();\n    this.cleanup();\n  }\n\n  private cleanup() {\n    if (this.raf1) cancelAnimationFrame(this.raf1);\n    if (this.raf2) cancelAnimationFrame(this.raf2);\n    this.raf1 = this.raf2 = null;\n\n    window.removeEventListener('resize', this.onWin);\n    window.removeEventListener('scroll', this.onWin, true);\n\n    document.removeEventListener('mousedown', this.onDocDownCapture, true);\n    document.removeEventListener('click', this.onDocClickCapture, true);\n    document.removeEventListener('keydown', this.onKey);\n  }\n\n  private onWin = () => {\n    if (!this.open) return;\n    this.positionAbove();\n    m.redraw();\n  };\n\n  private onKey = (ev: KeyboardEvent) => {\n    if (ev.key === 'Escape') this.close();\n  };\n\n  private onDocDownCapture = (ev: MouseEvent) => {\n    if (!this.open) return;\n\n    const target = ev.target as Node;\n    const moreRoot = this.element as HTMLElement | null;\n    const nativePopover = document.querySelector(\n      '.Magicbb-ColorPopover, .Magicbb-AlertPopover, .Magicbb-ImagePopover'\n    ) as HTMLElement | null;\n\n    const insideMore = !!moreRoot && moreRoot.contains(target);\n    const insideNative = !!nativePopover && nativePopover.contains(target);\n\n    if (insideMore || insideNative) return;\n    this.close();\n  };\n\n  private onDocClickCapture = (ev: MouseEvent) => {\n    if (!this.open) return;\n\n    const target = ev.target as Node;\n    const nativePopover = document.querySelector(\n      '.Magicbb-ColorPopover, .Magicbb-AlertPopover, .Magicbb-ImagePopover'\n    ) as HTMLElement | null;\n\n    if (nativePopover && nativePopover.contains(target)) {\n      requestAnimationFrame(() => this.close());\n    }\n  };\n\n  private positionAbove() {\n    const ar = this.anchor?.getBoundingClientRect();\n    if (!ar) return;\n\n    const rect = this.popEl?.getBoundingClientRect();\n    const pw = rect?.width ?? 240;\n    const ph = rect?.height ?? 44;\n\n    const vw = document.documentElement.clientWidth || window.innerWidth;\n    const isMobile = vw <= 768;\n\n    const leftGutter = 8;\n    const rightGutter = 8;\n\n    const reserveRightForInner = isMobile ? 220 : 0;\n\n    let left = Math.round(ar.left);\n\n    const maxLeft = vw - pw - reserveRightForInner - rightGutter;\n\n    if (left > maxLeft) left = Math.max(leftGutter, maxLeft);\n    if (left < leftGutter) left = leftGutter;\n\n    let top = Math.round(ar.top - ph - 6);\n    if (top < 8) top = 8;\n\n    this.pos.left = left;\n    this.pos.top = top;\n  }\n}","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport TextEditor from 'flarum/common/components/TextEditor';\nimport TextEditorButton from 'flarum/common/components/TextEditorButton';\nimport styleSelectedText from 'flarum/common/utils/styleSelectedText';\nimport ColorPalettePopover, { DEFAULT_COLORS } from './components/ColorPalettePopover';\nimport AlertPickerPopover from './components/AlertPickerPopover';\nimport ImageAlignPopover from './components/ImageAlignPopover';\nimport MoreButtonsPopover from './components/MoreButtonsPopover';\n\nfunction elOf(ctx) {\n  return ctx?.attrs?.composer?.editor?.el || null;\n}\nfunction edOf(ctx) {\n  return ctx?.attrs?.composer?.editor || null;\n}\nfunction featureOn(key) {\n  const v = app.forum.attribute(key);\n  return v === undefined || v === null ? true : !!v;\n}\nfunction findFoFTagAroundSelection(node) {\n  const re = /\\[upl-image-preview(?:(?!]).)*?\\burl=(?:\"[^\"]+\"|'[^']+'|[^\\s\\]]+)(?:(?!]).)*?]/i;\n  const start = Math.max(0, node.selectionStart - 800);\n  const end = Math.min(node.value.length, node.selectionEnd + 800);\n  const slice = node.value.slice(start, end);\n  const m = slice.match(re);\n  if (!m) return null;\n  const absStart = start + m.index;\n  const absEnd = absStart + m[0].length;\n  return { start: absStart, end: absEnd, text: m[0] };\n}\nfunction replaceRange(node, from, to, text) {\n  node.setRangeText(text, from, to, 'end');\n  node.dispatchEvent(new Event('input', { bubbles: true }));\n}\n\napp.initializers.add('capybash-magicbb-buttons', () => {\n  extend(TextEditor.prototype, 'toolbarItems', function (items) {\n    const el = () => elOf(this);\n    const editor = () => edOf(this);\n    const grouped = featureOn('bb_toolbar_group');\n\n    type PoolItem =\n      | {\n          key: string;\n          prio: number;\n          title: string;\n          icon?: string;\n          vnode: Mithril.Children;\n          asMenu: () => { key: string; title: string; icon?: string; onClick: (e: MouseEvent) => void };\n        }\n      | {\n          key: string;\n          prio: number;\n          title: string;\n          icon?: string;\n          vnode: Mithril.Children;\n          asMenuSub: () => { key: string; title: string; icon?: string; renderSub: () => Mithril.Children };\n        };\n\n    const iconOf = (name: string, fallback: string) =>\n      (app.forum.attribute(`icon_${name}`) as string) || fallback;\n\n    const pool: PoolItem[] = [];\n\n    const addBtn = (key, icon, title, style, prio, defaultText = '') => {\n      const handler = (e?: MouseEvent) => {\n        e?.preventDefault?.();\n        const node = el();\n        const ed = editor();\n        if (!node || !ed) return;\n\n        const hasSelection = node.selectionStart !== node.selectionEnd;\n        if (!hasSelection && defaultText) {\n          ed.insertAtCursor((style.prefix || '') + defaultText + (style.suffix || ''));\n        } else {\n          styleSelectedText(node, style);\n        }\n      };\n\n      pool.push({\n        key,\n        prio,\n        title,\n        icon,\n        vnode: m(TextEditorButton, { icon, title, onclick: handler }),\n        asMenu: () => ({ key, title, icon, onClick: handler }),\n      } as PoolItem);\n    };\n\n    if (featureOn('bb_center')) {\n      addBtn(\n        'bb-center',\n        iconOf('center', 'fas fa-align-center'),\n        app.translator.trans('capybash-magicbb.forum.composer.center_button'),\n        { prefix: '[center]', suffix: '[/center]', trimFirst: true, multiline: true },\n        100\n      );\n    }\n\n    if (featureOn('bb_justify')) {\n      addBtn(\n        'bb-justify',\n        iconOf('justify', 'fas fa-align-justify'),\n        app.translator.trans('capybash-magicbb.forum.composer.justify_button'),\n        { prefix: '[justify]', suffix: '[/justify]', trimFirst: true, multiline: true },\n        99\n      );\n    }\n\n    if (featureOn('bb_color')) {\n      const label = app.translator.trans('capybash-magicbb.forum.composer.color_button');\n      const colorIcon = iconOf('color', 'fas fa-palette');\n\n      const colorPopover = m(ColorPalettePopover, {\n        label,\n        icon: colorIcon,\n        colors: DEFAULT_COLORS,\n        onSelect: (hex: string) => {\n          const node = el();\n          const ed = editor();\n          if (!node || !ed) return;\n\n          const hasSelection = node.selectionStart !== node.selectionEnd;\n          const style = { prefix: `[color=${hex}]`, suffix: '[/color]' };\n\n          if (!hasSelection) ed.insertAtCursor(`${style.prefix}Heading${style.suffix}`);\n          else styleSelectedText(node, style);\n        },\n      });\n\n      pool.push({\n        key: 'bb-color',\n        prio: 98,\n        title: label,\n        icon: colorIcon,\n        vnode: colorPopover,\n        asMenuSub: () => ({\n          key: 'bb-color',\n          title: label,\n          icon: colorIcon,\n          renderSub: () => colorPopover,\n        }),\n      } as PoolItem);\n    }\n\n    if (featureOn('bb_spoiler')) {\n      addBtn(\n        'bb-spoiler',\n        iconOf('spoiler', 'fas fa-layer-group'),\n        app.translator.trans('capybash-magicbb.forum.composer.spoiler_button'),\n        { prefix: '[spoiler title=Heading]', suffix: '[/spoiler]' },\n        97,\n        'Subtitle'\n      );\n    }\n\n    if (featureOn('bb_table')) {\n      const title = app.translator.trans('capybash-magicbb.forum.composer.table_button');\n      const tableIcon = iconOf('table', 'fas fa-table');\n      const handler = (e?: MouseEvent) => {\n        e?.preventDefault?.();\n        const ed = editor();\n        if (!ed?.insertAtCursor) return;\n        const tpl =\n          '| Heading 1 | Heading 2 | Heading 3 |\\n' +\n          '|---|---|---|\\n' +\n          '| Cell 1 | Cell 2 | Cell 3 |\\n' +\n          '| Cell 4 | Cell 5 | Cell 6 |';\n        ed.insertAtCursor(tpl);\n      };\n\n      pool.push({\n        key: 'bb-table',\n        prio: 96,\n        title,\n        icon: tableIcon,\n        vnode: m(TextEditorButton, { icon: tableIcon, title, onclick: handler }),\n        asMenu: () => ({ key: 'bb-table', title, icon: tableIcon, onClick: handler }),\n      } as PoolItem);\n    }\n\n    if (featureOn('bb_info')) {\n      const label = app.translator.trans('capybash-magicbb.forum.composer.info_button');\n      const infoIcon = iconOf('info', 'fas fa-info-circle');\n\n      const alertPopover = m(AlertPickerPopover, {\n        label,\n        icon: infoIcon,\n        onSelect: (a: any) => {\n          const node = el();\n          const ed = editor();\n          if (!node || !ed) return;\n\n          const hasSelection = node.selectionStart !== node.selectionEnd;\n          const tag = a.key;\n          const prefix = `[${tag} title=Heading font=${a.font} bg=${a.bg} border=${a.border}]`;\n          const suffix = `[/${tag}]`;\n\n          if (!hasSelection) ed.insertAtCursor(`${prefix}Subtitle${suffix}`);\n          else styleSelectedText(node, { prefix, suffix });\n        },\n      });\n\n      pool.push({\n        key: 'bb-info',\n        prio: 95.5,\n        title: label,\n        icon: infoIcon,\n        vnode: alertPopover,\n        asMenuSub: () => ({\n          key: 'bb-info',\n          title: label,\n          icon: infoIcon,\n          renderSub: () => alertPopover,\n        }),\n      } as PoolItem);\n    }\n\n    if (featureOn('bb_image')) {\n      const label = app.translator.trans('capybash-magicbb.forum.composer.image_button');\n      const imageIcon = iconOf('image', 'fas fa-image');\n\n      const imagePopover = m(ImageAlignPopover, {\n        label,\n        icon: imageIcon,\n        onPick: (align: 'left' | 'right' | 'center') => {\n          const node = el();\n          const ed = editor();\n          if (!node || !ed) return;\n\n          const wrap = (tag: string) => ({ prefix: `[${tag}]`, suffix: `[/${tag}]` });\n          const style =\n            align === 'left' ? wrap('ileft') :\n            align === 'right' ? wrap('iright') :\n            wrap('icenter');\n\n          const hasSelection = node.selectionStart !== node.selectionEnd;\n\n          if (hasSelection) {\n            styleSelectedText(node, style);\n            return;\n          }\n\n          const found = findFoFTagAroundSelection(node);\n          if (found) {\n            const replacement = `${style.prefix}${found.text}${style.suffix}`;\n            replaceRange(node, found.start, found.end, replacement);\n            return;\n          }\n\n          ed.insertAtCursor(`${style.prefix}upl-image-preview uuid${style.suffix}`);\n        },\n      });\n\n      pool.push({\n        key: 'bb-image',\n        prio: 95,\n        title: label,\n        icon: imageIcon,\n        vnode: imagePopover,\n        asMenuSub: () => ({\n          key: 'bb-image',\n          title: label,\n          icon: imageIcon,\n          renderSub: () => imagePopover,\n        }),\n      } as PoolItem);\n    }\n\n    pool.sort((a, b) => b.prio - a.prio);\n\n    if (grouped) {\n      const menuItems = pool.map((p) =>\n        ('asMenuSub' in p ? (p as any).asMenuSub() : (p as any).asMenu())\n      );\n\n      const moreIcon = iconOf('more', 'fas fa-wand-sparkles');\n\n      items.add(\n        'bb-more',\n        m(MoreButtonsPopover, {\n          items: menuItems,\n          label: app.translator.trans('capybash-magicbb.forum.composer.more_button'),\n          icon: moreIcon,\n        }),\n        120\n      );\n    } else {\n      pool.forEach((b: any) => items.add(b.key, b.vnode, b.prio));\n    }\n  });\n});"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","_setPrototypeOf","t","e","setPrototypeOf","bind","__proto__","_inheritsLoose","create","constructor","DEFAULT_COLORS","ColorPalettePopover","_Component","apply","arguments","_proto","oninit","_this","this","open","anchor","_onDocClick","_this$anchor","pop","popoverEl","contains","target","close","_onKey","onremove","document","removeEventListener","toggle","addEventListener","m","redraw","view","vnode","_this2","_vnode$attrs","attrs","label","_vnode$attrs$colors","colors","onSelect","icon","app","attribute","trigger","type","title","String","style","onclick","preventDefault","currentTarget","blur","oncreate","v","dom","className","r","getBoundingClientRect","position","left","width","top","transform","fragment","map","hex","Component","ALERTS","font","bg","border","AlertPickerPopover","add","rm","CHOICES","ImageAlignPopover","isOpen","popover","anc","onPick","c","MoreButtonsPopover","_len","length","args","Array","_key","concat","popEl","pos","visible","raf1","raf2","onWin","positionAbove","onKey","ev","onDocDownCapture","moreRoot","element","nativePopover","querySelector","insideMore","insideNative","onDocClickCapture","requestAnimationFrame","items","class","Button","visibility","willChange","cleanup","role","it","renderSub","tabindex","fn","onClick","openPopover","window","passive","cancelAnimationFrame","_this$popEl","_rect$width","_rect$height","ar","rect","pw","ph","height","vw","documentElement","clientWidth","innerWidth","reserveRightForInner","Math","round","maxLeft","max","featureOn","extend","TextEditor","el","ctx","_ctx$attrs","composer","editor","_ctx$attrs2","grouped","iconOf","name","fallback","pool","addBtn","prio","defaultText","handler","node","ed","selectionStart","selectionEnd","insertAtCursor","prefix","suffix","styleSelectedText","push","TextEditorButton","asMenu","trans","trimFirst","multiline","colorIcon","colorPopover","asMenuSub","tableIcon","infoIcon","alertPopover","hasSelection","tag","imageIcon","imagePopover","align","found","start","end","min","value","slice","match","absStart","index","text","findFoFTagAroundSelection","replacement","from","to","setRangeText","dispatchEvent","Event","bubbles","replaceRange","sort","b","menuItems","p","moreIcon","forEach"],"sourceRoot":""}