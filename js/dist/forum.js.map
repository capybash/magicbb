{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@capybash/magicbb/webpack/bootstrap","webpack://@capybash/magicbb/webpack/runtime/compat get default export","webpack://@capybash/magicbb/webpack/runtime/define property getters","webpack://@capybash/magicbb/webpack/runtime/hasOwnProperty shorthand","webpack://@capybash/magicbb/external root \"flarum.core.compat['forum/app']\"","webpack://@capybash/magicbb/external root \"flarum.core.compat['common/extend']\"","webpack://@capybash/magicbb/external root \"flarum.core.compat['common/components/TextEditor']\"","webpack://@capybash/magicbb/external root \"flarum.core.compat['common/components/TextEditorButton']\"","webpack://@capybash/magicbb/external root \"flarum.core.compat['common/utils/styleSelectedText']\"","webpack://@capybash/magicbb/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@capybash/magicbb/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@capybash/magicbb/external root \"flarum.core.compat['common/Component']\"","webpack://@capybash/magicbb/./src/forum/components/ColorPalettePopover.tsx","webpack://@capybash/magicbb/./src/forum/components/AlertPickerPopover.tsx","webpack://@capybash/magicbb/./src/forum/components/ImageAlignPopover.tsx","webpack://@capybash/magicbb/external root \"flarum.core.compat['common/components/Button']\"","webpack://@capybash/magicbb/./src/forum/components/MoreButtonsPopover.tsx","webpack://@capybash/magicbb/./src/forum/index.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditor'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditorButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/styleSelectedText'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","import Component from 'flarum/common/Component';\n\nconst DEFAULT_COLORS = [\n  '#FF4D4D', '#FF8A3D', '#FFD53D', '#22C55E',\n  '#06B6D4', '#3B82F6', '#4F46E5', '#A855F7',\n  '#EB8A90', '#DED9E2', '#536873', '#FEFEE3',\n  '#2F3437', '#6B3F2B', '#121212', '#7F1D1D',\n];\n\nexport default class ColorPalettePopover extends Component {\n  oninit() {\n    this.open = false;\n    this.anchor = null;\n\n    this._onDocClick = (e) => {\n      if (!this.open) return;\n      const pop = this.popoverEl;\n      if (!pop) return;\n      if (!pop.contains(e.target) && !this.anchor?.contains(e.target)) this.close();\n    };\n\n    this._onKey = (e) => {\n      if (e.key === 'Escape') this.close();\n    };\n  }\n\n  onremove() {\n    document.removeEventListener('mousedown', this._onDocClick);\n    document.removeEventListener('keydown', this._onKey);\n  }\n\n  toggle() {\n    this.open = !this.open;\n    if (this.open) {\n      document.addEventListener('mousedown', this._onDocClick);\n      document.addEventListener('keydown', this._onKey);\n    } else {\n      document.removeEventListener('mousedown', this._onDocClick);\n      document.removeEventListener('keydown', this._onKey);\n    }\n  }\n\n  close() {\n    if (!this.open) return;\n    this.open = false;\n    document.removeEventListener('mousedown', this._onDocClick);\n    document.removeEventListener('keydown', this._onKey);\n    m.redraw();\n  }\n\n  view(vnode) {\n    const { label, icon = 'fas fa-palette', colors = DEFAULT_COLORS, onSelect } = vnode.attrs;\n\n    const trigger = m(\n      'button.Button.Button--icon',\n      {\n        type: 'button',\n        title: label,\n        'aria-haspopup': 'dialog',\n        'aria-expanded': String(this.open),\n        style: 'background:transparent;box-shadow:none;transform:none;',\n        onclick: (e) => {\n          e.preventDefault();\n          this.toggle();\n          e.currentTarget.blur();\n        },\n        oncreate: (v) => (this.anchor = v.dom),\n      },\n      m('i', { className: `icon ${icon}`, 'aria-hidden': 'true' })\n    );\n\n    let style = null;\n    if (this.open && this.anchor) {\n      const r = this.anchor.getBoundingClientRect();\n      style = {\n        position: 'fixed',\n        left: `${r.left + r.width / 2}px`,\n        top: `${r.top}px`,\n        transform: 'translate(-50%, calc(-100% - 8px))',\n      };\n    }\n\n    return m.fragment({ key: 'magicbb-color' }, [\n      trigger,\n      this.open &&\n        m(\n          'div.Magicbb-ColorPopover',\n          {\n            style,\n            oncreate: (v) => (this.popoverEl = v.dom),\n            onremove: () => (this.popoverEl = null),\n          },\n          m(\n            'div.Magicbb-ColorGrid',\n            (colors || DEFAULT_COLORS).map((hex) =>\n              m('button.Magicbb-Color', {\n                type: 'button',\n                title: hex,\n                'aria-label': hex,\n                style: `background:${hex}`,\n                onclick: (e) => {\n                  e.preventDefault();\n                  onSelect?.(hex);\n                  this.close();\n                },\n              })\n            )\n          )\n        ),\n    ]);\n  }\n}\n\nexport { DEFAULT_COLORS };","import Component from 'flarum/common/Component';\n\nconst ALERTS = [\n  { key: 'info',    icon: 'fas fa-circle-info',          font: '#1d4ed8', bg: '#eff6ff', border: '#60a5fa' },\n  { key: 'success', icon: 'fas fa-check',                 font: '#047857', bg: '#ecfdf5', border: '#34d399' },\n  { key: 'warning', icon: 'fas fa-triangle-exclamation',  font: '#b45309', bg: '#fffbeb', border: '#fbbf24' },\n  { key: 'error',   icon: 'fas fa-xmark',                 font: '#b91c1c', bg: '#fef2f2', border: '#f87171' },\n];\n\nexport default class AlertPickerPopover extends Component {\n  oninit() {\n    this.open = false;\n    this.anchor = null;\n\n    this._onDocClick = (e) => {\n      if (!this.open) return;\n      const pop = this.popoverEl;\n      if (!pop) return;\n      if (!pop.contains(e.target) && !this.anchor?.contains(e.target)) this.close();\n    };\n    this._onKey = (e) => { if (e.key === 'Escape') this.close(); };\n  }\n\n  onremove() {\n    document.removeEventListener('mousedown', this._onDocClick);\n    document.removeEventListener('keydown', this._onKey);\n  }\n\n  toggle() {\n    this.open = !this.open;\n    const add = document.addEventListener.bind(document);\n    const rm  = document.removeEventListener.bind(document);\n    if (this.open) {\n      add('mousedown', this._onDocClick);\n      add('keydown', this._onKey);\n    } else {\n      rm('mousedown', this._onDocClick);\n      rm('keydown', this._onKey);\n    }\n  }\n\n  close() {\n    if (!this.open) return;\n    this.open = false;\n    document.removeEventListener('mousedown', this._onDocClick);\n    document.removeEventListener('keydown', this._onKey);\n    m.redraw();\n  }\n\n  view(vnode) {\n    const { label, icon = 'fas fa-circle-exclamation', onSelect } = vnode.attrs;\n\n    const trigger = m(\n      'button.Button.Button--icon',\n      {\n        type: 'button',\n        title: label,\n        'aria-haspopup': 'dialog',\n        'aria-expanded': String(this.open),\n        style: 'background:transparent;box-shadow:none;transform:none;',\n        onclick: (e) => { e.preventDefault(); this.toggle(); e.currentTarget.blur(); },\n        oncreate: (v) => (this.anchor = v.dom),\n      },\n      m('i', { className: `icon ${icon}`, 'aria-hidden': 'true' })\n    );\n\n    let style = null;\n    if (this.open && this.anchor) {\n      const r = this.anchor.getBoundingClientRect();\n      style = { position: 'fixed', left: `${r.left + r.width / 2}px`, top: `${r.top}px`, transform: 'translate(-50%, calc(-100% - 8px))' };\n    }\n\n    return m.fragment({ key: 'magicbb-alert' }, [\n      trigger,\n      this.open &&\n        m('div.Magicbb-AlertPopover',\n          {\n            style,\n            oncreate: (v) => (this.popoverEl = v.dom),\n            onremove: () => (this.popoverEl = null),\n          },\n          m('div.Magicbb-AlertGrid',\n            ALERTS.map((a) =>\n              m('button.Magicbb-AlertChoice',\n                {\n                  type: 'button',\n                  title: a.key,\n                  'aria-label': a.key,\n                  style: `background:${a.font}`,\n                  onclick: (e) => { e.preventDefault(); onSelect?.(a); this.close(); },\n                },\n                m('i', { className: `icon ${a.icon}`, 'aria-hidden': 'true', style: 'color:#fff' })\n              )\n            )\n          )\n        ),\n    ]);\n  }\n}\n\nexport { ALERTS };","import Component from 'flarum/common/Component';\n\nconst CHOICES = [\n  { key: 'left',   icon: 'fas fa-align-left',   title: 'Left' },\n  { key: 'center', icon: 'fas fa-align-center', title: 'Center' },\n  { key: 'right',  icon: 'fas fa-align-right',  title: 'Right' },\n];\n\nexport default class ImageAlignPopover extends Component {\n  oninit() {\n    this.isOpen = false;\n    this.anchor = null;\n    this.popover = null;\n\n    this._onDocClick = (e) => {\n      if (!this.isOpen) return;\n      const pop = this.popover;\n      const anc = this.anchor;\n      if (!pop || !anc) return;\n      if (!pop.contains(e.target) && !anc.contains(e.target)) this.close();\n    };\n\n    this._onKey = (e) => {\n      if (e.key === 'Escape') this.close();\n    };\n  }\n\n  onremove() {\n    document.removeEventListener('mousedown', this._onDocClick);\n    document.removeEventListener('keydown', this._onKey);\n  }\n\n  open() {\n    if (this.isOpen) return;\n    this.isOpen = true;\n    document.addEventListener('mousedown', this._onDocClick);\n    document.addEventListener('keydown', this._onKey);\n  }\n\n  close() {\n    if (!this.isOpen) return;\n    this.isOpen = false;\n    document.removeEventListener('mousedown', this._onDocClick);\n    document.removeEventListener('keydown', this._onKey);\n    m.redraw();\n  }\n\n  toggle() {\n    this.isOpen ? this.close() : this.open();\n  }\n\n  view(vnode) {\n    const label = vnode.attrs.label || 'Image';\n    const onPick = vnode.attrs.onPick || function () {};\n\n    const trigger = m(\n      'button.Button.Button--icon',\n      {\n        type: 'button',\n        title: label,\n        'aria-haspopup': 'dialog',\n        'aria-expanded': String(this.isOpen),\n        onclick: (e) => {\n          e.preventDefault();\n          this.toggle();\n          e.currentTarget.blur();\n        },\n        oncreate: (v) => { this.anchor = v.dom; },\n        style: 'background:transparent;box-shadow:none;transform:none;',\n      },\n      m('i', { className: 'icon fas fa-images', 'aria-hidden': 'true' })\n    );\n\n    let style = null;\n    if (this.isOpen && this.anchor) {\n      const r = this.anchor.getBoundingClientRect();\n      style = {\n        position: 'fixed',\n        left: (r.left + r.width / 2) + 'px',\n        top: r.top + 'px',\n        transform: 'translate(-50%, calc(-100% - 8px))',\n      };\n    }\n\n    const popover = this.isOpen\n      ? m('div.Magicbb-ImagePopover',\n          {\n            style,\n            oncreate: (v) => { this.popover = v.dom; },\n            onremove: () => { this.popover = null; },\n          },\n          m('div.Magicbb-ImageGrid',\n            CHOICES.map((c) =>\n              m(\n                'button.Magicbb-ImageChoice',\n                {\n                  type: 'button',\n                  title: c.title,\n                  'aria-label': c.title,\n                  onclick: (e) => {\n                    e.preventDefault();\n                    onPick(c.key);\n                    this.close();\n                  },\n                },\n                m('i', { className: 'icon ' + c.icon, 'aria-hidden': 'true' })\n              )\n            )\n          )\n        )\n      : null;\n\n    return [trigger, popover];\n  }\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","import Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\n\ntype PlainAction = {\n  key: string;\n  title: string;\n  icon?: string;\n  onClick: (e: MouseEvent) => void;\n};\n\ntype SubPopoverAction = {\n  key: string;\n  title: string;\n  icon?: string;\n  renderSub: () => Mithril.Children;\n};\n\ntype MenuItem = PlainAction | SubPopoverAction;\n\nfunction isSub(item: MenuItem): item is SubPopoverAction {\n  return typeof (item as any).renderSub === 'function';\n}\n\nexport default class MoreButtonsPopover extends Component<{ items: MenuItem[]; label?: string }> {\n  private open = false;\n  private anchor?: HTMLElement;\n  private popEl?: HTMLElement;\n  private pos = { top: -9999, left: -9999 };\n  private visible = false;\n  private raf1: number | null = null;\n  private raf2: number | null = null;\n\n  view() {\n    const { items } = this.attrs;\n\n    return (\n      <span class=\"Magicbb-MoreWrap\" style=\"display:inline-block\">\n        <Button\n          className=\"Button Button--icon Button--link\"\n          icon=\"fas fa-wand-sparkles\"\n          onclick={(e: any) => {\n            e?.preventDefault?.();\n            this.anchor = e.currentTarget as HTMLElement;\n            this.toggle();\n          }}\n          title={this.attrs.label || 'More'}\n          aria-expanded={this.open ? 'true' : 'false'}\n          aria-haspopup=\"menu\"\n        />\n\n        {this.open && (\n          <div\n            class=\"Magicbb-MorePopover\"\n            style={{\n              top: `${this.pos.top}px`,\n              left: `${this.pos.left}px`,\n              visibility: this.visible ? 'visible' : 'hidden',\n              willChange: 'top, left',\n            }}\n            oncreate={(vnode: any) => {\n              this.popEl = vnode.dom as HTMLElement;\n              this.raf1 = requestAnimationFrame(() => {\n                this.positionAbove();\n                this.raf2 = requestAnimationFrame(() => {\n                  this.positionAbove();\n                  this.visible = true;\n                  m.redraw();\n                });\n              });\n            }}\n            onremove={() => this.cleanup()}\n            role=\"menu\"\n          >\n            <div class=\"Magicbb-MoreRow\">\n              {items.map((it) =>\n                isSub(it) ? (\n                  <span\n                    key={it.key}\n                    class=\"Magicbb-MoreBtnIcon\"\n                    title={it.title}\n                    role=\"menuitem\"\n                    tabindex=\"0\"\n                    aria-label={it.title}\n                    aria-haspopup=\"dialog\"\n                    aria-expanded=\"false\"\n                  >\n                    {it.renderSub()}\n                  </span>\n                ) : (\n                  <button\n                    key={it.key}\n                    class=\"Magicbb-MoreBtnIcon\"\n                    role=\"menuitem\"\n                    title={it.title}\n                    aria-label={it.title}\n                    type=\"button\"\n                    onclick={(e: any) => {\n                      e?.preventDefault?.();\n                      const fn = (it as PlainAction).onClick;\n                      this.close();\n                      requestAnimationFrame(() => fn(e));\n                    }}\n                  >\n                    {it.icon ? <i class={it.icon} aria-hidden=\"true\" /> : <i class=\"fas fa-circle\" style=\"opacity:.35\" aria-hidden=\"true\" />}\n                  </button>\n                )\n              )}\n            </div>\n          </div>\n        )}\n      </span>\n    );\n  }\n\n  private toggle() { this.open ? this.close() : this.openPopover(); }\n\n  private openPopover() {\n    this.open = true;\n    this.visible = false;\n    this.pos = { top: -9999, left: -9999 };\n    m.redraw();\n\n    window.addEventListener('resize', this.onWin, { passive: true });\n    window.addEventListener('scroll', this.onWin, true);\n\n    document.addEventListener('mousedown', this.onDocDownCapture, true);\n    document.addEventListener('click', this.onDocClickCapture, true);\n    document.addEventListener('keydown', this.onKey);\n  }\n\n  private close() {\n    this.open = false;\n    this.visible = false;\n    m.redraw();\n    this.cleanup();\n  }\n\n  private cleanup() {\n    if (this.raf1) cancelAnimationFrame(this.raf1);\n    if (this.raf2) cancelAnimationFrame(this.raf2);\n    this.raf1 = this.raf2 = null;\n\n    window.removeEventListener('resize', this.onWin);\n    window.removeEventListener('scroll', this.onWin, true);\n\n    document.removeEventListener('mousedown', this.onDocDownCapture, true);\n    document.removeEventListener('click', this.onDocClickCapture, true);\n    document.removeEventListener('keydown', this.onKey);\n  }\n\n  private onWin = () => {\n    if (!this.open) return;\n    this.positionAbove();\n    m.redraw();\n  };\n\n  private onKey = (ev: KeyboardEvent) => {\n    if (ev.key === 'Escape') this.close();\n  };\n\n  private onDocDownCapture = (ev: MouseEvent) => {\n    if (!this.open) return;\n\n    const target = ev.target as Node;\n    const moreRoot = this.element as HTMLElement | null;\n    const nativePopover = document.querySelector(\n      '.Magicbb-ColorPopover, .Magicbb-AlertPopover, .Magicbb-ImagePopover'\n    ) as HTMLElement | null;\n\n    const insideMore = !!moreRoot && moreRoot.contains(target);\n    const insideNative = !!nativePopover && nativePopover.contains(target);\n\n    if (insideMore || insideNative) return;\n    this.close();\n  };\n\n  private onDocClickCapture = (ev: MouseEvent) => {\n    if (!this.open) return;\n\n    const target = ev.target as Node;\n    const nativePopover = document.querySelector(\n      '.Magicbb-ColorPopover, .Magicbb-AlertPopover, .Magicbb-ImagePopover'\n    ) as HTMLElement | null;\n\n    if (nativePopover && nativePopover.contains(target)) {\n      requestAnimationFrame(() => this.close());\n    }\n  };\n\n  private positionAbove() {\n    const ar = this.anchor?.getBoundingClientRect();\n    if (!ar) return;\n\n    const rect = this.popEl?.getBoundingClientRect();\n    const pw = rect?.width ?? 240;\n    const ph = rect?.height ?? 44;\n\n    const vw = document.documentElement.clientWidth || window.innerWidth;\n    const isMobile = vw <= 768;\n\n    const leftGutter = 8;\n    const rightGutter = 8;\n\n    const reserveRightForInner = isMobile ? 220 : 0;\n\n    let left = Math.round(ar.left);\n\n    const maxLeft = vw - pw - reserveRightForInner - rightGutter;\n\n    if (left > maxLeft) left = Math.max(leftGutter, maxLeft);\n    if (left < leftGutter) left = leftGutter;\n\n    let top = Math.round(ar.top - ph - 6);\n    if (top < 8) top = 8;\n\n    this.pos.left = left;\n    this.pos.top = top;\n  }\n}","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport TextEditor from 'flarum/common/components/TextEditor';\nimport TextEditorButton from 'flarum/common/components/TextEditorButton';\nimport styleSelectedText from 'flarum/common/utils/styleSelectedText';\nimport ColorPalettePopover, { DEFAULT_COLORS } from './components/ColorPalettePopover';\nimport AlertPickerPopover from './components/AlertPickerPopover';\nimport ImageAlignPopover from './components/ImageAlignPopover';\nimport MoreButtonsPopover from './components/MoreButtonsPopover';\n\nfunction elOf(ctx) {\n  return ctx?.attrs?.composer?.editor?.el || null;\n}\nfunction edOf(ctx) {\n  return ctx?.attrs?.composer?.editor || null;\n}\nfunction featureOn(key) {\n  const v = app.forum.attribute(key);\n  return v === undefined || v === null ? true : !!v;\n}\nfunction findFoFTagAroundSelection(node) {\n  const re = /\\[upl-image-preview(?:(?!]).)*?\\burl=(?:\"[^\"]+\"|'[^']+'|[^\\s\\]]+)(?:(?!]).)*?]/i;\n  const start = Math.max(0, node.selectionStart - 800);\n  const end = Math.min(node.value.length, node.selectionEnd + 800);\n  const slice = node.value.slice(start, end);\n  const m = slice.match(re);\n  if (!m) return null;\n  const absStart = start + m.index;\n  const absEnd = absStart + m[0].length;\n  return { start: absStart, end: absEnd, text: m[0] };\n}\nfunction replaceRange(node, from, to, text) {\n  node.setRangeText(text, from, to, 'end');\n  node.dispatchEvent(new Event('input', { bubbles: true }));\n}\n\napp.initializers.add('capybash-magicbb-buttons', () => {\n  extend(TextEditor.prototype, 'toolbarItems', function (items) {\n    const el = () => elOf(this);\n    const editor = () => edOf(this);\n    const grouped = featureOn('bb_toolbar_group');\n\n    type PoolItem =\n      | {\n          key: string;\n          prio: number;\n          title: string;\n          icon?: string;\n          vnode: Mithril.Children;\n          asMenu: () => { key: string; title: string; icon?: string; onClick: (e: MouseEvent) => void };\n        }\n      | {\n          key: string;\n          prio: number;\n          title: string;\n          icon?: string;\n          vnode: Mithril.Children;\n          asMenuSub: () => { key: string; title: string; icon?: string; renderSub: () => Mithril.Children };\n        };\n\n    const pool: PoolItem[] = [];\n\n    const addBtn = (key, icon, title, style, prio, defaultText = '') => {\n      const handler = (e?: MouseEvent) => {\n        e?.preventDefault?.();\n        const node = el();\n        const ed = editor();\n        if (!node || !ed) return;\n\n        const hasSelection = node.selectionStart !== node.selectionEnd;\n        if (!hasSelection && defaultText) {\n          ed.insertAtCursor((style.prefix || '') + defaultText + (style.suffix || ''));\n        } else {\n          styleSelectedText(node, style);\n        }\n      };\n\n      pool.push({\n        key,\n        prio,\n        title,\n        icon,\n        vnode: m(TextEditorButton, { icon, title, onclick: handler }),\n        asMenu: () => ({ key, title, icon, onClick: handler }),\n      } as PoolItem);\n    };\n\n    if (featureOn('bb_center')) {\n      addBtn(\n        'bb-center',\n        'fas fa-align-center',\n        app.translator.trans('capybash-magicbb.forum.composer.center_button'),\n        { prefix: '[center]', suffix: '[/center]', trimFirst: true, multiline: true },\n        100\n      );\n    }\n\n    if (featureOn('bb_justify')) {\n      addBtn(\n        'bb-justify',\n        'fas fa-align-justify',\n        app.translator.trans('capybash-magicbb.forum.composer.justify_button'),\n        { prefix: '[justify]', suffix: '[/justify]', trimFirst: true, multiline: true },\n        99\n      );\n    }\n\n    if (featureOn('bb_color')) {\n      const label = app.translator.trans('capybash-magicbb.forum.composer.color_button');\n\n      const colorPopover = m(ColorPalettePopover, {\n        label,\n        colors: DEFAULT_COLORS,\n        onSelect: (hex: string) => {\n          const node = el();\n          const ed = editor();\n          if (!node || !ed) return;\n\n          const hasSelection = node.selectionStart !== node.selectionEnd;\n          const style = { prefix: `[color=${hex}]`, suffix: '[/color]' };\n\n          if (!hasSelection) ed.insertAtCursor(`${style.prefix}Heading${style.suffix}`);\n          else styleSelectedText(node, style);\n        },\n      });\n\n      pool.push({\n        key: 'bb-color',\n        prio: 98,\n        title: label,\n        icon: 'fas fa-palette',\n        vnode: colorPopover,\n        asMenuSub: () => ({\n          key: 'bb-color',\n          title: label,\n          icon: 'fas fa-palette',\n          renderSub: () => colorPopover,\n        }),\n      } as PoolItem);\n    }\n\n    if (featureOn('bb_spoiler')) {\n      addBtn(\n        'bb-spoiler',\n        'fas fa-layer-group',\n        app.translator.trans('capybash-magicbb.forum.composer.spoiler_button'),\n        { prefix: '[spoiler title=Heading]', suffix: '[/spoiler]' },\n        97,\n        'Subtitle'\n      );\n    }\n\n    if (featureOn('bb_table')) {\n      const title = app.translator.trans('capybash-magicbb.forum.composer.table_button');\n      const handler = (e?: MouseEvent) => {\n        e?.preventDefault?.();\n        const ed = editor();\n        if (!ed?.insertAtCursor) return;\n        const tpl =\n          '| Heading 1 | Heading 2 | Heading 3 |\\n' +\n          '|---|---|---|\\n' +\n          '| Cell 1 | Cell 2 | Cell 3 |\\n' +\n          '| Cell 4 | Cell 5 | Cell 6 |';\n        ed.insertAtCursor(tpl);\n      };\n\n      pool.push({\n        key: 'bb-table',\n        prio: 96,\n        title,\n        icon: 'fas fa-table',\n        vnode: m(TextEditorButton, { icon: 'fas fa-table', title, onclick: handler }),\n        asMenu: () => ({ key: 'bb-table', title, icon: 'fas fa-table', onClick: handler }),\n      } as PoolItem);\n    }\n\n    if (featureOn('bb_info')) {\n      const label = app.translator.trans('capybash-magicbb.forum.composer.info_button');\n\n      const alertPopover = m(AlertPickerPopover, {\n        label,\n        onSelect: (a: any) => {\n          const node = el();\n          const ed = editor();\n          if (!node || !ed) return;\n\n          const hasSelection = node.selectionStart !== node.selectionEnd;\n          const tag = a.key;\n          const prefix = `[${tag} title=Heading font=${a.font} bg=${a.bg} border=${a.border}]`;\n          const suffix = `[/${tag}]`;\n\n          if (!hasSelection) ed.insertAtCursor(`${prefix}Subtitle${suffix}`);\n          else styleSelectedText(node, { prefix, suffix });\n        },\n      });\n\n      pool.push({\n        key: 'bb-info',\n        prio: 95.5,\n        title: label,\n        icon: 'fas fa-info-circle',\n        vnode: alertPopover,\n        asMenuSub: () => ({\n          key: 'bb-info',\n          title: label,\n          icon: 'fas fa-info-circle',\n          renderSub: () => alertPopover,\n        }),\n      } as PoolItem);\n    }\n\n    if (featureOn('bb_image')) {\n      const label = app.translator.trans('capybash-magicbb.forum.composer.image_button');\n\n      const imagePopover = m(ImageAlignPopover, {\n        label,\n        onPick: (align: 'left' | 'right' | 'center') => {\n          const node = el();\n          const ed = editor();\n          if (!node || !ed) return;\n\n          const wrap = (tag: string) => ({ prefix: `[${tag}]`, suffix: `[/${tag}]` });\n          const style =\n            align === 'left' ? wrap('ileft') :\n            align === 'right' ? wrap('iright') :\n            wrap('icenter');\n\n          const hasSelection = node.selectionStart !== node.selectionEnd;\n\n          if (hasSelection) {\n            styleSelectedText(node, style);\n            return;\n          }\n\n          const found = findFoFTagAroundSelection(node);\n          if (found) {\n            const replacement = `${style.prefix}${found.text}${style.suffix}`;\n            replaceRange(node, found.start, found.end, replacement);\n            return;\n          }\n\n          ed.insertAtCursor(`${style.prefix}upl-image-preview uuid${style.suffix}`);\n        },\n      });\n\n      pool.push({\n        key: 'bb-image',\n        prio: 95,\n        title: label,\n        icon: 'fas fa-image',\n        vnode: imagePopover,\n        asMenuSub: () => ({\n          key: 'bb-image',\n          title: label,\n          icon: 'fas fa-image',\n          renderSub: () => imagePopover,\n        }),\n      } as PoolItem);\n    }\n\n    pool.sort((a, b) => b.prio - a.prio);\n\n    if (grouped) {\n      const menuItems = pool.map((p) =>\n        ('asMenuSub' in p ? (p as any).asMenuSub() : (p as any).asMenu())\n      );\n\n      items.add(\n        'bb-more',\n        m(MoreButtonsPopover, {\n          items: menuItems,\n          label: app.translator.trans('capybash-magicbb.forum.composer.more_button'),\n        }),\n        120\n      );\n    } else {\n      pool.forEach((b: any) => items.add(b.key, b.vnode, b.prio));\n    }\n  });\n});"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","_setPrototypeOf","t","e","setPrototypeOf","bind","__proto__","_inheritsLoose","create","constructor","DEFAULT_COLORS","ColorPalettePopover","_Component","apply","arguments","_proto","oninit","_this","this","open","anchor","_onDocClick","_this$anchor","pop","popoverEl","contains","target","close","_onKey","onremove","document","removeEventListener","toggle","addEventListener","m","redraw","view","vnode","_this2","_vnode$attrs","attrs","label","_vnode$attrs$icon","icon","_vnode$attrs$colors","colors","onSelect","trigger","type","title","String","style","onclick","preventDefault","currentTarget","blur","oncreate","v","dom","className","r","getBoundingClientRect","position","left","width","top","transform","fragment","map","hex","Component","ALERTS","font","bg","border","AlertPickerPopover","add","rm","CHOICES","ImageAlignPopover","isOpen","popover","anc","onPick","c","MoreButtonsPopover","_len","length","args","Array","_key","concat","popEl","pos","visible","raf1","raf2","onWin","positionAbove","onKey","ev","onDocDownCapture","moreRoot","element","nativePopover","querySelector","insideMore","insideNative","onDocClickCapture","requestAnimationFrame","items","class","Button","visibility","willChange","cleanup","role","it","renderSub","tabindex","fn","onClick","openPopover","window","passive","cancelAnimationFrame","_this$popEl","_rect$width","_rect$height","ar","rect","pw","ph","height","vw","documentElement","clientWidth","innerWidth","reserveRightForInner","Math","round","maxLeft","max","featureOn","app","attribute","extend","TextEditor","el","ctx","_ctx$attrs","composer","editor","_ctx$attrs2","grouped","pool","addBtn","prio","defaultText","handler","node","ed","selectionStart","selectionEnd","insertAtCursor","prefix","suffix","styleSelectedText","push","TextEditorButton","asMenu","trans","trimFirst","multiline","colorPopover","asMenuSub","alertPopover","hasSelection","tag","imagePopover","align","found","start","end","min","value","slice","match","absStart","index","text","findFoFTagAroundSelection","replacement","from","to","setRangeText","dispatchEvent","Event","bubbles","replaceRange","sort","b","menuItems","p","forEach"],"sourceRoot":""}