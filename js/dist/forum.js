module.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=9)}([,function(t,e){t.exports=flarum.core.compat["forum/app"]},function(t,e,n){"use strict";function o(t,e){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function i(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,o(t,e)}n.d(e,"a",(function(){return i}))},function(t,e){t.exports=flarum.core.compat["common/Component"]},function(t,e){t.exports=flarum.core.compat["common/utils/styleSelectedText"]},function(t,e){t.exports=flarum.core.compat["common/components/TextEditorButton"]},function(t,e){t.exports=flarum.core.compat["common/extend"]},function(t,e){t.exports=flarum.core.compat["common/components/TextEditor"]},,function(t,e,n){"use strict";n.r(e);var o=n(1),i=n.n(o),r=n(6),a=n(7),c=n.n(a),s=n(5),l=n.n(s),u=n(4),f=n.n(u),p=n(2),d=n(3),b=n.n(d),h=["#FF4D4D","#FF8A3D","#FFD53D","#22C55E","#06B6D4","#3B82F6","#4F46E5","#A855F7","#EB8A90","#DED9E2","#536873","#FEFEE3","#2F3437","#6B3F2B","#121212","#7F1D1D"],v=function(t){function e(){return t.apply(this,arguments)||this}Object(p.a)(e,t);var n=e.prototype;return n.oninit=function(){var t=this;this.open=!1,this.anchor=null,this._onDocClick=function(e){var n;if(t.open){var o=t.popoverEl;o&&(o.contains(e.target)||null!=(n=t.anchor)&&n.contains(e.target)||t.close())}},this._onKey=function(e){"Escape"===e.key&&t.close()}},n.onremove=function(){document.removeEventListener("mousedown",this._onDocClick),document.removeEventListener("keydown",this._onKey)},n.toggle=function(){this.open=!this.open,this.open?(document.addEventListener("mousedown",this._onDocClick),document.addEventListener("keydown",this._onKey)):(document.removeEventListener("mousedown",this._onDocClick),document.removeEventListener("keydown",this._onKey))},n.close=function(){this.open&&(this.open=!1,document.removeEventListener("mousedown",this._onDocClick),document.removeEventListener("keydown",this._onKey),m.redraw())},n.view=function(t){var e=this,n=t.attrs,o=n.label,i=n.icon,r=void 0===i?"fas fa-palette":i,a=n.colors,c=void 0===a?h:a,s=n.onSelect,l=m("button.Button.Button--icon",{type:"button",title:o,"aria-haspopup":"dialog","aria-expanded":String(this.open),style:"background:transparent;box-shadow:none;transform:none;",onclick:function(t){t.preventDefault(),e.toggle(),t.currentTarget.blur()},oncreate:function(t){return e.anchor=t.dom}},m("i",{className:"icon "+r,"aria-hidden":"true"})),u=null;if(this.open&&this.anchor){var f=this.anchor.getBoundingClientRect();u={position:"fixed",left:f.left+f.width/2+"px",top:f.top+"px",transform:"translate(-50%, calc(-100% - 8px))"}}return m.fragment({key:"magicbb-color"},[l,this.open&&m("div.Magicbb-ColorPopover",{style:u,oncreate:function(t){return e.popoverEl=t.dom},onremove:function(){return e.popoverEl=null}},m("div.Magicbb-ColorGrid",(c||h).map((function(t){return m("button.Magicbb-Color",{type:"button",title:t,"aria-label":t,style:"background:"+t,onclick:function(n){n.preventDefault(),null==s||s(t),e.close()}})}))))])},e}(b.a),g=[{key:"info",icon:"fas fa-circle-info",font:"#1d4ed8",bg:"#eff6ff",border:"#60a5fa"},{key:"success",icon:"fas fa-check",font:"#047857",bg:"#ecfdf5",border:"#34d399"},{key:"warning",icon:"fas fa-triangle-exclamation",font:"#b45309",bg:"#fffbeb",border:"#fbbf24"},{key:"error",icon:"fas fa-xmark",font:"#b91c1c",bg:"#fef2f2",border:"#f87171"}],y=function(t){function e(){return t.apply(this,arguments)||this}Object(p.a)(e,t);var n=e.prototype;return n.oninit=function(){var t=this;this.open=!1,this.anchor=null,this._onDocClick=function(e){var n;if(t.open){var o=t.popoverEl;o&&(o.contains(e.target)||null!=(n=t.anchor)&&n.contains(e.target)||t.close())}},this._onKey=function(e){"Escape"===e.key&&t.close()}},n.onremove=function(){document.removeEventListener("mousedown",this._onDocClick),document.removeEventListener("keydown",this._onKey)},n.toggle=function(){this.open=!this.open;var t=document.addEventListener.bind(document),e=document.removeEventListener.bind(document);this.open?(t("mousedown",this._onDocClick),t("keydown",this._onKey)):(e("mousedown",this._onDocClick),e("keydown",this._onKey))},n.close=function(){this.open&&(this.open=!1,document.removeEventListener("mousedown",this._onDocClick),document.removeEventListener("keydown",this._onKey),m.redraw())},n.view=function(t){var e=this,n=t.attrs,o=n.label,i=n.icon,r=void 0===i?"fas fa-circle-exclamation":i,a=n.onSelect,c=m("button.Button.Button--icon",{type:"button",title:o,"aria-haspopup":"dialog","aria-expanded":String(this.open),style:"background:transparent;box-shadow:none;transform:none;",onclick:function(t){t.preventDefault(),e.toggle(),t.currentTarget.blur()},oncreate:function(t){return e.anchor=t.dom}},m("i",{className:"icon "+r,"aria-hidden":"true"})),s=null;if(this.open&&this.anchor){var l=this.anchor.getBoundingClientRect();s={position:"fixed",left:l.left+l.width/2+"px",top:l.top+"px",transform:"translate(-50%, calc(-100% - 8px))"}}return m.fragment({key:"magicbb-alert"},[c,this.open&&m("div.Magicbb-AlertPopover",{style:s,oncreate:function(t){return e.popoverEl=t.dom},onremove:function(){return e.popoverEl=null}},m("div.Magicbb-AlertGrid",g.map((function(t){return m("button.Magicbb-AlertChoice",{type:"button",title:t.key,"aria-label":t.key,style:"background:"+t.font,onclick:function(n){n.preventDefault(),null==a||a(t),e.close()}},m("i",{className:"icon "+t.icon,"aria-hidden":"true",style:"color:#fff"}))}))))])},e}(b.a),x=[{key:"left",icon:"fas fa-align-left",title:"Left"},{key:"center",icon:"fas fa-align-center",title:"Center"},{key:"right",icon:"fas fa-align-right",title:"Right"}],k=function(t){function e(){return t.apply(this,arguments)||this}Object(p.a)(e,t);var n=e.prototype;return n.oninit=function(){var t=this;this.isOpen=!1,this.anchor=null,this.popover=null,this._onDocClick=function(e){if(t.isOpen){var n=t.popover,o=t.anchor;n&&o&&(n.contains(e.target)||o.contains(e.target)||t.close())}},this._onKey=function(e){"Escape"===e.key&&t.close()}},n.onremove=function(){document.removeEventListener("mousedown",this._onDocClick),document.removeEventListener("keydown",this._onKey)},n.open=function(){this.isOpen||(this.isOpen=!0,document.addEventListener("mousedown",this._onDocClick),document.addEventListener("keydown",this._onKey))},n.close=function(){this.isOpen&&(this.isOpen=!1,document.removeEventListener("mousedown",this._onDocClick),document.removeEventListener("keydown",this._onKey),m.redraw())},n.toggle=function(){this.isOpen?this.close():this.open()},n.view=function(t){var e=this,n=t.attrs.label||"Image",o=t.attrs.onPick||function(){},i=m("button.Button.Button--icon",{type:"button",title:n,"aria-haspopup":"dialog","aria-expanded":String(this.isOpen),onclick:function(t){t.preventDefault(),e.toggle(),t.currentTarget.blur()},oncreate:function(t){e.anchor=t.dom},style:"background:transparent;box-shadow:none;transform:none;"},m("i",{className:"icon fas fa-images","aria-hidden":"true"})),r=null;if(this.isOpen&&this.anchor){var a=this.anchor.getBoundingClientRect();r={position:"fixed",left:a.left+a.width/2+"px",top:a.top+"px",transform:"translate(-50%, calc(-100% - 8px))"}}return[i,this.isOpen?m("div.Magicbb-ImagePopover",{style:r,oncreate:function(t){e.popover=t.dom},onremove:function(){e.popover=null}},m("div.Magicbb-ImageGrid",x.map((function(t){return m("button.Magicbb-ImageChoice",{type:"button",title:t.title,"aria-label":t.title,onclick:function(n){n.preventDefault(),o(t.key),e.close()}},m("i",{className:"icon "+t.icon,"aria-hidden":"true"}))})))):null]},e}(b.a);function _(t){var e=i.a.forum.attribute(t);return null==e||!!e}i.a.initializers.add("capybash-magicbb-buttons",(function(){Object(r.extend)(c.a.prototype,"toolbarItems",(function(t){var e=this,n=function(){return(null==(t=e)||null==(n=t.attrs)||null==(n=n.composer)||null==(n=n.editor)?void 0:n.el)||null;var t,n},o=function(){return(null==(t=e)||null==(n=t.attrs)||null==(n=n.composer)?void 0:n.editor)||null;var t,n},r=function(e,i,r,a,c,s){void 0===s&&(s=""),t.add(e,m(l.a,{icon:i,title:r,onclick:function(t){null==t||null==t.preventDefault||t.preventDefault();var e=n(),i=o();e&&i&&(!(e.selectionStart!==e.selectionEnd)&&s?i.insertAtCursor((a.prefix||"")+s+(a.suffix||"")):f()(e,a))}}),c)};if(_("bb_center")&&r("bb-center","fas fa-align-center",i.a.translator.trans("capybash-magicbb.forum.composer.center_button"),{prefix:"[center]",suffix:"[/center]",trimFirst:!0,multiline:!0},100),_("bb_justify")&&r("bb-justify","fas fa-align-justify",i.a.translator.trans("capybash-magicbb.forum.composer.justify_button"),{prefix:"[justify]",suffix:"[/justify]",trimFirst:!0,multiline:!0},99),_("bb_color")){var a=i.a.translator.trans("capybash-magicbb.forum.composer.color_button");t.add("bb-color",m(v,{label:a,colors:h,onSelect:function(t){var e=n(),i=o();if(e&&i){var r={prefix:"[color="+t+"]",suffix:"[/color]"};e.selectionStart!==e.selectionEnd?f()(e,r):i.insertAtCursor(r.prefix+"Heading"+r.suffix)}}}),98)}if(_("bb_spoiler")&&r("bb-spoiler","fas fa-layer-group",i.a.translator.trans("capybash-magicbb.forum.composer.spoiler_button"),{prefix:"[spoiler title=Heading]",suffix:"[/spoiler]"},97,"Subtitle"),_("bb_table")&&t.add("bb-table",m(l.a,{icon:"fas fa-table",title:i.a.translator.trans("capybash-magicbb.forum.composer.table_button"),onclick:function(t){null==t||null==t.preventDefault||t.preventDefault();var e=o();if(null!=e&&e.insertAtCursor){e.insertAtCursor("| Heading 1 | Heading 2 | Heading 3 |\n|---|---|---|\n| Cell 1 | Cell 2 | Cell 3 |\n| Cell 4 | Cell 5 | Cell 6 |")}}}),96),_("bb_info")){var c=i.a.translator.trans("capybash-magicbb.forum.composer.info_button");t.add("bb-info",m(y,{label:c,onSelect:function(t){var e=n(),i=o();if(e&&i){var r=e.selectionStart!==e.selectionEnd,a=t.key,c="["+a+" title=Heading font="+t.font+" bg="+t.bg+" border="+t.border+"]",s="[/"+a+"]";r?f()(e,{prefix:c,suffix:s}):i.insertAtCursor(c+"Subtitle"+s)}}}),95.5)}if(_("bb_image")){var s=i.a.translator.trans("capybash-magicbb.forum.composer.image_button");t.add("bb-image",m(k,{label:s,onPick:function(t){var e=n(),i=o();if(e&&i){var r=function(t){return{prefix:"["+t+"]",suffix:"[/"+t+"]"}},a=r("left"===t?"ileft":"right"===t?"iright":"icenter");if(e.selectionStart!==e.selectionEnd)f()(e,a);else{var c=function(t){var e=Math.max(0,t.selectionStart-800),n=Math.min(t.value.length,t.selectionEnd+800),o=t.value.slice(e,n).match(/\[upl-image-preview(?:(?!]).)*?\burl=(?:"[^"]+"|'[^']+'|[^\s\]]+)(?:(?!]).)*?]/i);if(!o)return null;var i=e+o.index;return{start:i,end:i+o[0].length,text:o[0]}}(e);if(c){var s=""+a.prefix+c.text+a.suffix;!function(t,e,n,o){t.setRangeText(o,e,n,"end"),t.dispatchEvent(new Event("input",{bubbles:!0}))}(e,c.start,c.end,s)}else i.insertAtCursor(a.prefix+"upl-image-preview uuid"+a.suffix)}}}}),95)}}))}))}]);
//# sourceMappingURL=forum.js.map